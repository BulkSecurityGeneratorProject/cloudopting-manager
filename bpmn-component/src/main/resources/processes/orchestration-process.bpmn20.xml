<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="Examples">
  <process id="cloudoptingProcess" name="The CloudOpting Orchestration Process" isExecutable="true">
    <startEvent id="theStart"></startEvent>
    <sequenceFlow id="fromStart" sourceRef="theStart" targetRef="getCustomization"></sequenceFlow>
    <serviceTask id="vmTask" name="generating the VM" activiti:delegateExpression="${deployGenerateVm}">
      <documentation>In this task we issue the creation of the VM using the Jclouds library.
This task also prepares the array of Dockercontainers that the process will have to work on.
In this task we can also process the array of ports that we need to open.

For cleanness we could in the end split this task into a task for analyzing the tosca file and one to create the VM</documentation>
    </serviceTask>
    <endEvent id="theEnd"></endEvent>
    <sequenceFlow id="toJoinVm" sourceRef="vmTask" targetRef="join1"></sequenceFlow>
    <serviceTask id="vmInstalledTask" name="Check VM installed" activiti:delegateExpression="${deployCheckVm}">
      <documentation>Here we check the cloud to have confirmation of the VM creation and getting IP information in return since we will have to open ports and add to Docker Swarm</documentation>
    </serviceTask>
    <exclusiveGateway id="split1" name="Exclusive Gateway"></exclusiveGateway>
    <exclusiveGateway id="join1" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="toForkVM" sourceRef="vmInstalledTask" targetRef="split1"></sequenceFlow>
    <sequenceFlow id="vmNotInstalled" name="Vm not yet installed" sourceRef="split1" targetRef="join1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vmInstalled== false}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="toCheckVM" sourceRef="join1" targetRef="vmInstalledTask"></sequenceFlow>
    <sequenceFlow id="vmInstalled" name="VM installed" sourceRef="split1" targetRef="acquireIpTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vmInstalled== true}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="toSwarm" sourceRef="subPorts" targetRef="servicetask1"></sequenceFlow>
    <sequenceFlow id="toSubprocess" sourceRef="servicetask1" targetRef="subDockerPuppetPrepare"></sequenceFlow>
    <serviceTask id="deployOnDockerTask" name="Deploy on Docker Host" activiti:delegateExpression="${deploy}"></serviceTask>
    <sequenceFlow id="toJoinCheckDeploy" sourceRef="deployOnDockerTask" targetRef="exclusivegateway8"></sequenceFlow>
    <subProcess id="subDockerPuppetPrepare" name="Dockerfile and image management">
      <documentation>In the subprocess we manage the creation of the Puppet node manifest, of the Dockerfile and the generation of the docker image</documentation>
      <multiInstanceLoopCharacteristics isSequential="true" activiti:collection="dockerNodesList" activiti:elementVariable="dockerNode"></multiInstanceLoopCharacteristics>
      <startEvent id="startDockerGenSub" name="Start"></startEvent>
      <serviceTask id="dockerTask" name="generating the Dockerfile" activiti:delegateExpression="${deployGenerateDocker}">
        <documentation>This task is a multi instance that means that the process will instantiate one of this task for all the container nodes it finds in the TOSCA file.
This task will probably be transformed into a subprocess, but at the moment we needd to start mapping stuff</documentation>
      </serviceTask>
      <sequenceFlow id="toEndSub" sourceRef="dockerTask" targetRef="endDockerGenSub"></sequenceFlow>
      <endEvent id="endDockerGenSub" name="End"></endEvent>
      <sequenceFlow id="toGenerateDocker" sourceRef="startDockerGenSub" targetRef="dockerTask"></sequenceFlow>
    </subProcess>
    <sequenceFlow id="toR10k" sourceRef="subDockerPuppetPrepare" targetRef="r10kTask"></sequenceFlow>
    <serviceTask id="servicetask1" name="Add new VM to docker swarm" activiti:delegateExpression="${deployDockerSwarm}"></serviceTask>
    <serviceTask id="setupTask" name="setup Process" activiti:delegateExpression="${deploySetup}"></serviceTask>
    <sequenceFlow id="toGetTosca" sourceRef="setupTask" targetRef="getToscaCsar"></sequenceFlow>
    <subProcess id="subDockerBuild" name="Build Docker Containers">
      <multiInstanceLoopCharacteristics isSequential="true" activiti:collection="dockerNodesList" activiti:elementVariable="dockerNode"></multiInstanceLoopCharacteristics>
      <serviceTask id="buildTask" name="build the Docker image" activiti:delegateExpression="${deployDockerBuild}"></serviceTask>
      <sequenceFlow id="toJoinBuild" sourceRef="buildTask" targetRef="join3"></sequenceFlow>
      <startEvent id="startBuildSub" name="Start"></startEvent>
      <sequenceFlow id="toBuild" sourceRef="startBuildSub" targetRef="buildTask"></sequenceFlow>
      <endEvent id="endBuildSub" name="End"></endEvent>
      <serviceTask id="checkBuild" name="Check build result" activiti:delegateExpression="${deployCheckBuild}"></serviceTask>
      <sequenceFlow id="toForkBuild" sourceRef="checkBuild" targetRef="fork3"></sequenceFlow>
      <exclusiveGateway id="join3" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="toCheckBuild" sourceRef="join3" targetRef="checkBuild"></sequenceFlow>
      <exclusiveGateway id="fork3" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="noBuild" sourceRef="fork3" targetRef="join3">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkBuild==false}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="buildOk" sourceRef="fork3" targetRef="endBuildSub">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkBuild==true}]]></conditionExpression>
      </sequenceFlow>
    </subProcess>
    <serviceTask id="r10kTask" name="run R10K" activiti:delegateExpression="${deployRunr10k}"></serviceTask>
    <sequenceFlow id="toCheckContext" sourceRef="r10kTask" targetRef="join2"></sequenceFlow>
    <sequenceFlow id="toCompose" sourceRef="subDockerBuild" targetRef="taskDockerComposeFile"></sequenceFlow>
    <serviceTask id="taskDockerComposeFile" name="Prepare Docker Compose file" activiti:delegateExpression="${deployDockerCompose}"></serviceTask>
    <sequenceFlow id="toDeploy" sourceRef="taskDockerComposeFile" targetRef="deployOnDockerTask"></sequenceFlow>
    <serviceTask id="getCustomization" name="Get service customization" activiti:async="true" activiti:delegateExpression="${deployManageCustomization}"></serviceTask>
    <serviceTask id="getCustomer" name="Get customer information" activiti:delegateExpression="${deployManageCustomer}"></serviceTask>
    <serviceTask id="getToscaCsar" name="Get TOSCA csar" activiti:delegateExpression="${deployManageTosca}"></serviceTask>
    <sequenceFlow id="toCustomer" sourceRef="getCustomization" targetRef="getCustomer"></sequenceFlow>
    <sequenceFlow id="toSetup" sourceRef="getCustomer" targetRef="setupTask"></sequenceFlow>
    <sequenceFlow id="toVm" sourceRef="getToscaCsar" targetRef="vmTask"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway8" name="Exclusive Gateway"></exclusiveGateway>
    <exclusiveGateway id="exclusivegateway9" name="Exclusive Gateway"></exclusiveGateway>
    <serviceTask id="checkDeploy" name="Check Deploy" activiti:delegateExpression="${deployCheckDeploy}"></serviceTask>
    <sequenceFlow id="toCkeckDeploy" sourceRef="exclusivegateway8" targetRef="checkDeploy"></sequenceFlow>
    <sequenceFlow id="toForkDeploy" sourceRef="checkDeploy" targetRef="exclusivegateway9"></sequenceFlow>
    <sequenceFlow id="deploy" sourceRef="exclusivegateway9" targetRef="cleanup">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkDeploy==true}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="noDeploy" sourceRef="exclusivegateway9" targetRef="exclusivegateway8">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkDeploy==false}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="cleanup" name="Clean Up" activiti:delegateExpression="${deployCleanUp}"></serviceTask>
    <sequenceFlow id="toEnd" sourceRef="cleanup" targetRef="theEnd"></sequenceFlow>
    <exclusiveGateway id="join2" name="Exclusive Gateway"></exclusiveGateway>
    <exclusiveGateway id="split2" name="Exclusive Gateway"></exclusiveGateway>
    <serviceTask id="chkcontext" name="Check context" activiti:delegateExpression="${deployCheckContext}"></serviceTask>
    <sequenceFlow id="fromJoinContext" sourceRef="join2" targetRef="chkcontext"></sequenceFlow>
    <sequenceFlow id="toForkContext" sourceRef="chkcontext" targetRef="split2"></sequenceFlow>
    <sequenceFlow id="noContext" sourceRef="split2" targetRef="join2">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkContext==false}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="okContext" sourceRef="split2" targetRef="subDockerBuild">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkContext==true}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="acquireIpTask" name="Acquire IP" activiti:delegateExpression="${deployAcquireIp}"></serviceTask>
    <serviceTask id="chkAquireIp" name="Check Acquire" activiti:delegateExpression="${deployCheckAcquireIp}"></serviceTask>
    <exclusiveGateway id="joinIp" name="Exclusive Gateway"></exclusiveGateway>
    <exclusiveGateway id="splitIp" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="toJoinIp" sourceRef="acquireIpTask" targetRef="joinIp"></sequenceFlow>
    <sequenceFlow id="fromJoinIp" sourceRef="joinIp" targetRef="chkAquireIp"></sequenceFlow>
    <sequenceFlow id="toSplitIp" sourceRef="chkAquireIp" targetRef="splitIp"></sequenceFlow>
    <sequenceFlow id="ipNotAcquired" sourceRef="splitIp" targetRef="joinIp">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkAcquiredIp==false}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="ipAcquired" sourceRef="splitIp" targetRef="subPorts">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkAcquiredIp==true}]]></conditionExpression>
    </sequenceFlow>
    <subProcess id="subPorts" name="manage ports on VM">
      <multiInstanceLoopCharacteristics isSequential="false" activiti:collection="vmPortsList" activiti:elementVariable="vmPort"></multiInstanceLoopCharacteristics>
      <startEvent id="startPorts" name="Start"></startEvent>
      <endEvent id="endPorts" name="End"></endEvent>
      <serviceTask id="forwardTask" name="Port Forward" activiti:delegateExpression="${deployPortForward}"></serviceTask>
      <serviceTask id="chkForwardTask" name="Check Port Forward" activiti:delegateExpression="${deployCheckPortForward}"></serviceTask>
      <serviceTask id="chkFirewallTask" name="CheckFirewall Rule" activiti:delegateExpression="${deployCheckFirewall}"></serviceTask>
      <serviceTask id="firewallTask" name="Firewall Rule" activiti:delegateExpression="${deployFirewall}"></serviceTask>
      <exclusiveGateway id="joinForward" name="Exclusive Gateway"></exclusiveGateway>
      <exclusiveGateway id="splitFirewall" name="Exclusive Gateway"></exclusiveGateway>
      <exclusiveGateway id="splitForward" name="Exclusive Gateway"></exclusiveGateway>
      <exclusiveGateway id="joinFirewall" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="toForward" sourceRef="startPorts" targetRef="forwardTask"></sequenceFlow>
      <sequenceFlow id="toJoinForward" sourceRef="forwardTask" targetRef="joinForward"></sequenceFlow>
      <sequenceFlow id="toChkForward" sourceRef="joinForward" targetRef="chkForwardTask"></sequenceFlow>
      <sequenceFlow id="flow4" sourceRef="chkForwardTask" targetRef="splitForward"></sequenceFlow>
      <sequenceFlow id="notForwarded" sourceRef="splitForward" targetRef="joinForward">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkForward==false}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="toFirewall" sourceRef="splitForward" targetRef="firewallTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkForward==true}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="toJoinFirewall" sourceRef="firewallTask" targetRef="joinFirewall"></sequenceFlow>
      <sequenceFlow id="toChkFirewall" sourceRef="joinFirewall" targetRef="chkFirewallTask"></sequenceFlow>
      <sequenceFlow id="toSlitFirewall" sourceRef="chkFirewallTask" targetRef="splitFirewall"></sequenceFlow>
      <sequenceFlow id="toEndPorts" sourceRef="splitFirewall" targetRef="endPorts">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkFirewall==true}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="noFirewallRuled" sourceRef="splitFirewall" targetRef="joinFirewall">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${chkFirewall==false}]]></conditionExpression>
      </sequenceFlow>
    </subProcess>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_cloudoptingProcess">
    <bpmndi:BPMNPlane bpmnElement="cloudoptingProcess" id="BPMNPlane_cloudoptingProcess">
      <bpmndi:BPMNShape bpmnElement="theStart" id="BPMNShape_theStart">
        <omgdc:Bounds height="35.0" width="35.0" x="1.0" y="97.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="vmTask" id="BPMNShape_vmTask">
        <omgdc:Bounds height="60.0" width="100.0" x="212.0" y="81.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="theEnd" id="BPMNShape_theEnd">
        <omgdc:Bounds height="35.0" width="35.0" x="1019.0" y="610.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="vmInstalledTask" id="BPMNShape_vmInstalledTask">
        <omgdc:Bounds height="55.0" width="105.0" x="411.0" y="83.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="split1" id="BPMNShape_split1">
        <omgdc:Bounds height="40.0" width="40.0" x="532.0" y="90.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="join1" id="BPMNShape_join1">
        <omgdc:Bounds height="40.0" width="40.0" x="340.0" y="90.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="deployOnDockerTask" id="BPMNShape_deployOnDockerTask">
        <omgdc:Bounds height="61.0" width="105.0" x="981.0" y="221.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="subDockerPuppetPrepare" id="BPMNShape_subDockerPuppetPrepare">
        <omgdc:Bounds height="161.0" width="395.0" x="128.0" y="230.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startDockerGenSub" id="BPMNShape_startDockerGenSub">
        <omgdc:Bounds height="35.0" width="35.0" x="143.0" y="291.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dockerTask" id="BPMNShape_dockerTask">
        <omgdc:Bounds height="78.0" width="105.0" x="318.0" y="270.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endDockerGenSub" id="BPMNShape_endDockerGenSub">
        <omgdc:Bounds height="35.0" width="35.0" x="468.0" y="291.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask1" id="BPMNShape_servicetask1">
        <omgdc:Bounds height="71.0" width="105.0" x="819.0" y="150.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="setupTask" id="BPMNShape_setupTask">
        <omgdc:Bounds height="55.0" width="105.0" x="209.0" y="10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="subDockerBuild" id="BPMNShape_subDockerBuild">
        <omgdc:Bounds height="151.0" width="586.0" x="108.0" y="436.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="buildTask" id="BPMNShape_buildTask">
        <omgdc:Bounds height="63.0" width="105.0" x="178.0" y="481.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startBuildSub" id="BPMNShape_startBuildSub">
        <omgdc:Bounds height="35.0" width="35.0" x="111.0" y="495.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endBuildSub" id="BPMNShape_endBuildSub">
        <omgdc:Bounds height="35.0" width="35.0" x="601.0" y="496.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="checkBuild" id="BPMNShape_checkBuild">
        <omgdc:Bounds height="55.0" width="105.0" x="371.0" y="485.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="join3" id="BPMNShape_join3">
        <omgdc:Bounds height="40.0" width="40.0" x="311.0" y="492.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="fork3" id="BPMNShape_fork3">
        <omgdc:Bounds height="40.0" width="40.0" x="511.0" y="493.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="r10kTask" id="BPMNShape_r10kTask">
        <omgdc:Bounds height="55.0" width="105.0" x="559.0" y="283.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskDockerComposeFile" id="BPMNShape_taskDockerComposeFile">
        <omgdc:Bounds height="55.0" width="105.0" x="839.0" y="283.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getCustomization" id="BPMNShape_getCustomization">
        <omgdc:Bounds height="55.0" width="105.0" x="68.0" y="83.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getCustomer" id="BPMNShape_getCustomer">
        <omgdc:Bounds height="55.0" width="105.0" x="68.0" y="10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="getToscaCsar" id="BPMNShape_getToscaCsar">
        <omgdc:Bounds height="55.0" width="105.0" x="351.0" y="10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway8" id="BPMNShape_exclusivegateway8">
        <omgdc:Bounds height="40.0" width="40.0" x="1013.0" y="318.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway9" id="BPMNShape_exclusivegateway9">
        <omgdc:Bounds height="40.0" width="40.0" x="1013.0" y="459.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="checkDeploy" id="BPMNShape_checkDeploy">
        <omgdc:Bounds height="55.0" width="105.0" x="981.0" y="380.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="cleanup" id="BPMNShape_cleanup">
        <omgdc:Bounds height="55.0" width="105.0" x="984.0" y="530.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="join2" id="BPMNShape_join2">
        <omgdc:Bounds height="40.0" width="40.0" x="644.0" y="231.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="split2" id="BPMNShape_split2">
        <omgdc:Bounds height="40.0" width="40.0" x="700.0" y="303.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="chkcontext" id="BPMNShape_chkcontext">
        <omgdc:Bounds height="55.0" width="105.0" x="703.0" y="225.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="acquireIpTask" id="BPMNShape_acquireIpTask">
        <omgdc:Bounds height="55.0" width="105.0" x="500.0" y="10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="chkAquireIp" id="BPMNShape_chkAquireIp">
        <omgdc:Bounds height="55.0" width="105.0" x="711.0" y="10.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="joinIp" id="BPMNShape_joinIp">
        <omgdc:Bounds height="40.0" width="40.0" x="641.0" y="17.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="splitIp" id="BPMNShape_splitIp">
        <omgdc:Bounds height="40.0" width="40.0" x="851.0" y="17.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="subPorts" id="BPMNShape_subPorts">
        <omgdc:Bounds height="205.0" width="501.0" x="960.0" y="8.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startPorts" id="BPMNShape_startPorts">
        <omgdc:Bounds height="35.0" width="35.0" x="970.0" y="40.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endPorts" id="BPMNShape_endPorts">
        <omgdc:Bounds height="35.0" width="35.0" x="970.0" y="160.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="forwardTask" id="BPMNShape_forwardTask">
        <omgdc:Bounds height="55.0" width="105.0" x="1100.0" y="30.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="chkForwardTask" id="BPMNShape_chkForwardTask">
        <omgdc:Bounds height="55.0" width="105.0" x="1270.0" y="30.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="chkFirewallTask" id="BPMNShape_chkFirewallTask">
        <omgdc:Bounds height="55.0" width="105.0" x="1100.0" y="150.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="firewallTask" id="BPMNShape_firewallTask">
        <omgdc:Bounds height="55.0" width="105.0" x="1270.0" y="150.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="joinForward" id="BPMNShape_joinForward">
        <omgdc:Bounds height="40.0" width="40.0" x="1220.0" y="37.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="splitFirewall" id="BPMNShape_splitFirewall">
        <omgdc:Bounds height="40.0" width="40.0" x="1040.0" y="157.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="splitForward" id="BPMNShape_splitForward">
        <omgdc:Bounds height="40.0" width="40.0" x="1400.0" y="37.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="joinFirewall" id="BPMNShape_joinFirewall">
        <omgdc:Bounds height="40.0" width="40.0" x="1220.0" y="157.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="fromStart" id="BPMNEdge_fromStart">
        <omgdi:waypoint x="36.0" y="114.0"></omgdi:waypoint>
        <omgdi:waypoint x="68.0" y="110.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinVm" id="BPMNEdge_toJoinVm">
        <omgdi:waypoint x="312.0" y="111.0"></omgdi:waypoint>
        <omgdi:waypoint x="340.0" y="110.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toForkVM" id="BPMNEdge_toForkVM">
        <omgdi:waypoint x="516.0" y="110.0"></omgdi:waypoint>
        <omgdi:waypoint x="532.0" y="110.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="vmNotInstalled" id="BPMNEdge_vmNotInstalled">
        <omgdi:waypoint x="552.0" y="130.0"></omgdi:waypoint>
        <omgdi:waypoint x="552.0" y="202.0"></omgdi:waypoint>
        <omgdi:waypoint x="360.0" y="202.0"></omgdi:waypoint>
        <omgdi:waypoint x="360.0" y="130.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="36.0" width="65.0" x="495.0" y="149.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCheckVM" id="BPMNEdge_toCheckVM">
        <omgdi:waypoint x="380.0" y="110.0"></omgdi:waypoint>
        <omgdi:waypoint x="411.0" y="110.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="vmInstalled" id="BPMNEdge_vmInstalled">
        <omgdi:waypoint x="552.0" y="90.0"></omgdi:waypoint>
        <omgdi:waypoint x="552.0" y="65.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="36.0" width="41.0" x="532.0" y="66.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toSwarm" id="BPMNEdge_toSwarm">
        <omgdi:waypoint x="960.0" y="110.0"></omgdi:waypoint>
        <omgdi:waypoint x="871.0" y="150.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toSubprocess" id="BPMNEdge_toSubprocess">
        <omgdi:waypoint x="819.0" y="185.0"></omgdi:waypoint>
        <omgdi:waypoint x="325.0" y="230.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinCheckDeploy" id="BPMNEdge_toJoinCheckDeploy">
        <omgdi:waypoint x="1033.0" y="282.0"></omgdi:waypoint>
        <omgdi:waypoint x="1033.0" y="318.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toEndSub" id="BPMNEdge_toEndSub">
        <omgdi:waypoint x="423.0" y="309.0"></omgdi:waypoint>
        <omgdi:waypoint x="468.0" y="308.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toGenerateDocker" id="BPMNEdge_toGenerateDocker">
        <omgdi:waypoint x="178.0" y="308.0"></omgdi:waypoint>
        <omgdi:waypoint x="318.0" y="309.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toR10k" id="BPMNEdge_toR10k">
        <omgdi:waypoint x="523.0" y="310.0"></omgdi:waypoint>
        <omgdi:waypoint x="559.0" y="310.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toGetTosca" id="BPMNEdge_toGetTosca">
        <omgdi:waypoint x="314.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="351.0" y="37.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinBuild" id="BPMNEdge_toJoinBuild">
        <omgdi:waypoint x="283.0" y="512.0"></omgdi:waypoint>
        <omgdi:waypoint x="311.0" y="512.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toBuild" id="BPMNEdge_toBuild">
        <omgdi:waypoint x="146.0" y="512.0"></omgdi:waypoint>
        <omgdi:waypoint x="178.0" y="512.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toForkBuild" id="BPMNEdge_toForkBuild">
        <omgdi:waypoint x="476.0" y="512.0"></omgdi:waypoint>
        <omgdi:waypoint x="511.0" y="513.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCheckBuild" id="BPMNEdge_toCheckBuild">
        <omgdi:waypoint x="351.0" y="512.0"></omgdi:waypoint>
        <omgdi:waypoint x="371.0" y="512.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="noBuild" id="BPMNEdge_noBuild">
        <omgdi:waypoint x="531.0" y="533.0"></omgdi:waypoint>
        <omgdi:waypoint x="518.0" y="564.0"></omgdi:waypoint>
        <omgdi:waypoint x="327.0" y="564.0"></omgdi:waypoint>
        <omgdi:waypoint x="331.0" y="532.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="buildOk" id="BPMNEdge_buildOk">
        <omgdi:waypoint x="551.0" y="513.0"></omgdi:waypoint>
        <omgdi:waypoint x="601.0" y="513.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCheckContext" id="BPMNEdge_toCheckContext">
        <omgdi:waypoint x="611.0" y="283.0"></omgdi:waypoint>
        <omgdi:waypoint x="664.0" y="271.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCompose" id="BPMNEdge_toCompose">
        <omgdi:waypoint x="401.0" y="436.0"></omgdi:waypoint>
        <omgdi:waypoint x="891.0" y="338.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toDeploy" id="BPMNEdge_toDeploy">
        <omgdi:waypoint x="944.0" y="310.0"></omgdi:waypoint>
        <omgdi:waypoint x="1033.0" y="282.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCustomer" id="BPMNEdge_toCustomer">
        <omgdi:waypoint x="120.0" y="83.0"></omgdi:waypoint>
        <omgdi:waypoint x="120.0" y="65.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toSetup" id="BPMNEdge_toSetup">
        <omgdi:waypoint x="173.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="209.0" y="37.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toVm" id="BPMNEdge_toVm">
        <omgdi:waypoint x="403.0" y="65.0"></omgdi:waypoint>
        <omgdi:waypoint x="262.0" y="81.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toCkeckDeploy" id="BPMNEdge_toCkeckDeploy">
        <omgdi:waypoint x="1033.0" y="358.0"></omgdi:waypoint>
        <omgdi:waypoint x="1033.0" y="380.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toForkDeploy" id="BPMNEdge_toForkDeploy">
        <omgdi:waypoint x="1033.0" y="435.0"></omgdi:waypoint>
        <omgdi:waypoint x="1033.0" y="459.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="deploy" id="BPMNEdge_deploy">
        <omgdi:waypoint x="1033.0" y="499.0"></omgdi:waypoint>
        <omgdi:waypoint x="1036.0" y="530.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="noDeploy" id="BPMNEdge_noDeploy">
        <omgdi:waypoint x="1013.0" y="479.0"></omgdi:waypoint>
        <omgdi:waypoint x="973.0" y="479.0"></omgdi:waypoint>
        <omgdi:waypoint x="973.0" y="338.0"></omgdi:waypoint>
        <omgdi:waypoint x="1013.0" y="338.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toEnd" id="BPMNEdge_toEnd">
        <omgdi:waypoint x="1036.0" y="585.0"></omgdi:waypoint>
        <omgdi:waypoint x="1036.0" y="610.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="fromJoinContext" id="BPMNEdge_fromJoinContext">
        <omgdi:waypoint x="684.0" y="251.0"></omgdi:waypoint>
        <omgdi:waypoint x="703.0" y="252.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toForkContext" id="BPMNEdge_toForkContext">
        <omgdi:waypoint x="755.0" y="280.0"></omgdi:waypoint>
        <omgdi:waypoint x="720.0" y="303.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="noContext" id="BPMNEdge_noContext">
        <omgdi:waypoint x="720.0" y="303.0"></omgdi:waypoint>
        <omgdi:waypoint x="664.0" y="271.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="okContext" id="BPMNEdge_okContext">
        <omgdi:waypoint x="720.0" y="343.0"></omgdi:waypoint>
        <omgdi:waypoint x="401.0" y="436.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinIp" id="BPMNEdge_toJoinIp">
        <omgdi:waypoint x="605.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="641.0" y="37.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="fromJoinIp" id="BPMNEdge_fromJoinIp">
        <omgdi:waypoint x="681.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="711.0" y="37.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toSplitIp" id="BPMNEdge_toSplitIp">
        <omgdi:waypoint x="816.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="851.0" y="37.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ipNotAcquired" id="BPMNEdge_ipNotAcquired">
        <omgdi:waypoint x="871.0" y="57.0"></omgdi:waypoint>
        <omgdi:waypoint x="813.0" y="86.0"></omgdi:waypoint>
        <omgdi:waypoint x="662.0" y="86.0"></omgdi:waypoint>
        <omgdi:waypoint x="661.0" y="57.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="ipAcquired" id="BPMNEdge_ipAcquired">
        <omgdi:waypoint x="891.0" y="37.0"></omgdi:waypoint>
        <omgdi:waypoint x="960.0" y="110.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toForward" id="BPMNEdge_toForward">
        <omgdi:waypoint x="1005.0" y="57.0"></omgdi:waypoint>
        <omgdi:waypoint x="1100.0" y="57.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinForward" id="BPMNEdge_toJoinForward">
        <omgdi:waypoint x="1205.0" y="57.0"></omgdi:waypoint>
        <omgdi:waypoint x="1220.0" y="57.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toChkForward" id="BPMNEdge_toChkForward">
        <omgdi:waypoint x="1260.0" y="57.0"></omgdi:waypoint>
        <omgdi:waypoint x="1270.0" y="57.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="1375.0" y="57.0"></omgdi:waypoint>
        <omgdi:waypoint x="1400.0" y="57.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="notForwarded" id="BPMNEdge_notForwarded">
        <omgdi:waypoint x="1420.0" y="77.0"></omgdi:waypoint>
        <omgdi:waypoint x="1361.0" y="111.0"></omgdi:waypoint>
        <omgdi:waypoint x="1241.0" y="111.0"></omgdi:waypoint>
        <omgdi:waypoint x="1240.0" y="77.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toFirewall" id="BPMNEdge_toFirewall">
        <omgdi:waypoint x="1420.0" y="77.0"></omgdi:waypoint>
        <omgdi:waypoint x="1420.0" y="176.0"></omgdi:waypoint>
        <omgdi:waypoint x="1375.0" y="177.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toJoinFirewall" id="BPMNEdge_toJoinFirewall">
        <omgdi:waypoint x="1270.0" y="177.0"></omgdi:waypoint>
        <omgdi:waypoint x="1260.0" y="177.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toChkFirewall" id="BPMNEdge_toChkFirewall">
        <omgdi:waypoint x="1220.0" y="177.0"></omgdi:waypoint>
        <omgdi:waypoint x="1205.0" y="177.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toSlitFirewall" id="BPMNEdge_toSlitFirewall">
        <omgdi:waypoint x="1100.0" y="177.0"></omgdi:waypoint>
        <omgdi:waypoint x="1080.0" y="177.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toEndPorts" id="BPMNEdge_toEndPorts">
        <omgdi:waypoint x="1040.0" y="177.0"></omgdi:waypoint>
        <omgdi:waypoint x="1005.0" y="177.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="noFirewallRuled" id="BPMNEdge_noFirewallRuled">
        <omgdi:waypoint x="1060.0" y="157.0"></omgdi:waypoint>
        <omgdi:waypoint x="1059.0" y="132.0"></omgdi:waypoint>
        <omgdi:waypoint x="1238.0" y="132.0"></omgdi:waypoint>
        <omgdi:waypoint x="1240.0" y="157.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>